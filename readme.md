# @funbox/blueprinter-frontend

Рендерер API Blueprint - утилита, получающая на вход AST API в формате Elements и генерирующая HTML-страницу с документацией.

## Установка библиотеки

```
npm install --save @funbox/blueprinter-frontend
```

## Использование библиотеки

Добавить команды в `package.json`:

```json
{
  "scripts": {
    "dev": "node node_modules/@funbox/blueprinter-frontend/bin/index.js -i doc.apib -s -p 3000",
    "doc": "node node_modules/@funbox/blueprinter-frontend/bin/index.js -i doc.apib -o index.html"
  }
}
```

## Использование через Docker

Для использования @funbox/blueprinter-frontend в Docker-контейнере нужно выполнить следующую команду в директории с вашей apib-документацией:

```
docker run \
  --rm \
  -v $(pwd):/app \
 funbox/blueprinter -i doc.apib -o index.html
```

При запуске контейнера необходимо примонтировать хост-директорию с документацией в некоторую директорию в контейнере,
и затем указать путь к apib-файлу относительно созданного в контейнере пути.

По умолчанию рабочей директорией образа задана директория `/app`, поэтому удобнее всего смонтировать хост-директорию непосредственно
в `/app`. Тогда в качестве параметра можно передать просто название файла `файл-с-документацией.apib`.

### Использование через Docker в режиме dev-сервера

Для запуска в контейнере в режиме dev-сервера нужно выполнить следующую команду в директории с вашей apib-документацией:

```
docker run \
  --rm \
  -v /$(pwd):/app \
  -p 3000:3000 \
  funbox/blueprinter -i doc.apib -s -p 3000
```

Если в качестве аргумента для @funbox/blueprinter-frontend указан порт, отличный от `3000`, то нужно также опубликовать его при запуске контейнера,
указав в параметрах опцию `-p port:port`.

**Внимание!** При завершении процесса dev-сервера через `ctrl/cmd+c` процесс с контейнером отсоединяется (переводится в `detached`),
но контейнер при этом остаётся запущенным.

Чтобы остановить контейнер, используйте команды:
```
$ docker ps # смотрим ID запущенного контейнера
$ docker stop <container> # останавливаем контейнер с указанным ID
```

### Использование Docker-контейнера в Windows

При запуске контейнера в Windows нужно добавлять слэш (`/`) перед вызовом `pwd`. Таким образом, команда будет выглядеть так:

```
docker run \
  --rm \
  -v /$(pwd):/app \
  funbox/blueprinter -i doc.apib -o index.html
```

Кроме того, примонтированная директория может быть пустой. Если это так, то убедитесь, что в настройках Docker Desktop for Windows,
в разделе Shared Drives включен шаринг нужного диска (стоит галка).
Если диск не расшарен, необходимо отметить его как shared, применить изменения и перезапустить Docker Desktop.

## Поиск по документации

HTML-страница с отрендеренной документацией содержит поле поиска, которое облегчает задачу быстрого нахождения того или иного ресурса.

Поиск производится по следующим сущностям:
* заголовки и описания групп, ресурсов и экшенов;
* href экшенов.

При этом результаты поиска выводятся в следующем порядке:
1) совпадения по href экшенов;
2) совпадения по заголовкам групп, ресурсов и экшенов;
3) совпадения по описаниям групп, ресурсов и экшенов.

Кроме ввода обычного поискового запроса (например, `empl` или `сотр`), также доступны некоторые модификаторы (фильтры) поиска. В общем виде запрос с модификатором имеет вид `modType:modValue query`, где `query` — нужный поисковый запрос. В частности, доступны фильтры по типу ресурса и по HTTP-методу.

Фильтр по типу — `type:action query`. Возможные значения: `type:group query`, `type:resource query`, `type:action query`.

Фильтр по методу — `method:METHOD query`, где `METHOD` — нужный HTTP-метод (GET, POST, DELETE и так далее). Метод можно вводить как в нижнем регистре, так и в верхнем.

Таким образом, чтобы вывести только GET-запросы, у которых href содержит `employ`, можно ввести в поисковой строке
```
method:get employ
```

Чтобы модификатор применился, поисковый запрос должен начинаться с `modValue`. Это значит, что если необходимо найти в документации фразу `method:get - пример фильтра`,
можно использовать первым символом запроса пробел (` method:get - пример фильтра`). Модификатор при этом не применится, пробел учитываться не будет, а поиск будет выполняться
именно по фразе `method:get - пример фильтра`.

### Быстрый фокус на поле поиска

Нажатие клавиши `/` (forward slash) на клавиатуре позволяет автоматически установить фокус в поле поиска.
